this.Bigscreen||(this.Bigscreen={}),Bigscreen.CaptionControl=function(){function a(a){this.video=a}return a.prototype.captionsData=function(){var a,b,c,d,e;for(b=this.video.parentNode.querySelectorAll("track[kind=subtitles]"),e=[],c=0,d=b.length;d>c;c++)a=b[c],e.push(this.trackData(a));return e},a.prototype.trackData=function(a){return{language:a.getAttribute("srclang"),title:a.title||a.getAttribute("srclang")}},a.prototype.render=function(){var a;return a=this.captionsData(),JST["bigscreen/templates/caption_control"]({captionsData:a})},a}();var __bind=function(a,b){return function(){return a.apply(b,arguments)}};this.Bigscreen||(this.Bigscreen={}),Bigscreen.CaptionLayer=function(){function a(a){this.video=a,this.onTimeUpdate=__bind(this.onTimeUpdate,this),this.onLanguageChange=__bind(this.onLanguageChange,this),Bigscreen.Utils.Events.delegate("change",this.video.parentNode,".bigscreen-caption-control input",this.onLanguageChange),this.processedLanguages={error:"The selected language isn't available.",none:" "}}return a.prototype.onLanguageChange=function(a){var b,c;return c=a.target.value,this.processedLanguages[c]?this.setActiveLanguage(c):(b=this.video.querySelector("track[kind=subtitles][srclang="+c+"]"),this.processCaptionTrack(b))},a.prototype.processCaptionTrack=function(a){return this.request=new XMLHttpRequest,this.request.open("GET",a.getAttribute("src")),this.request.onreadystatechange=function(b){return function(){return 4===b.request.readyState?200===b.request.status?(b.parseCaptions(a.getAttribute("srclang"),b.request.responseText),b.setActiveLanguage(a.getAttribute("srclang"))):b.setActiveLanguage("error"):void 0}}(this),this.request.send()},a.prototype.parseCaptions=function(a,b){var c,d,e,f,g;for(f=/^[0-9]+$/,g=b.split(/\r?\n/),c=[],e=0;e<g.length;)g[e].match(f)&&(d={},d.times=this.parseTimeCode(g[e+1]),d.text=g[e+2],c.push(d)),e++;return this.processedLanguages[a]=c},a.prototype.parseTimeCode=function(a){var b,c,d,e,f,g;return g=/^([0-9]{2}):([0-9]{2}):([0-9]{2}),([0-9]{1,3}) --\> ([0-9]{2}):([0-9]{2}):([0-9]{2}),([0-9]{1,3})$/,d=g.exec(a),e={hours:parseInt(d[1],10),minutes:parseInt(d[2],10),seconds:parseInt(d[3],10),miliseconds:parseInt(d[4],10)},b={hours:parseInt(d[5],10),minutes:parseInt(d[6],10),seconds:parseInt(d[7],10),miliseconds:parseInt(d[8],10)},f=60*e.hours*60+60*e.minutes+e.seconds+e.miliseconds/1e3,c=60*b.hours*60+60*b.minutes+b.seconds+b.miliseconds/1e3,[f,c]},a.prototype.setActiveLanguage=function(a){return this.currentLanguage=this.processedLanguages[a],"string"==typeof this.currentLanguage?(this.video.removeEventListener("timeupdate",this.onTimeUpdate),this.showCaptionMessage(this.currentLanguage)):(this.video.removeEventListener("timeupdate",this.onTimeUpdate),this.video.addEventListener("timeupdate",this.onTimeUpdate))},a.prototype.showCaptionMessage=function(a){var b;return b=this.getElement().querySelector(".bigscreen-caption-content"),b.textContent=a},a.prototype.onTimeUpdate=function(){var a,b,c,d,e,f;for(b=this.video.currentTime,e=this.currentLanguage,f=[],c=0,d=e.length;d>c;c++)a=e[c],f.push(b>=a.times[0]&&b<a.times[1]?this.showCaptionMessage(a.text):void 0);return f},a.prototype.getElement=function(){return this.video.parentNode.querySelector(".bigscreen-caption-layer")},a.prototype.render=function(){return JST["bigscreen/templates/caption_layer"]()},a}();var __bind=function(a,b){return function(){return a.apply(b,arguments)}};this.Bigscreen||(this.Bigscreen={}),Bigscreen.FullscreenControl=function(){function a(a){this.video=a,this.onClick=__bind(this.onClick,this),this.isFullscreen=!1,Bigscreen.Utils.Events.delegate("click",this.video.parentNode,".bigscreen-fullscreen-control",this.onClick)}return a.prototype.onClick=function(){return this.isFullscreen===!0?this.exitFullscreen():this.enterFullscreen()},a.prototype.enterFullscreen=function(){return Bigscreen.Utils.ClassList.add("bigscreen-is-fullscreen",this.video.parentNode),this.isFullscreen=!0},a.prototype.exitFullscreen=function(){return Bigscreen.Utils.ClassList.remove("bigscreen-is-fullscreen",this.video.parentNode),this.isFullscreen=!1},a.prototype.getElement=function(){return this.video.parentNode.querySelector(".bigscreen-fullscreen-control")},a.prototype.render=function(){return JST["bigscreen/templates/fullscreen_control"]()},a}();var __bind=function(a,b){return function(){return a.apply(b,arguments)}};this.Bigscreen||(this.Bigscreen={}),Bigscreen.PauseButton=function(){function a(a){this.video=a,this.onClick=__bind(this.onClick,this),this.wasPlayed=__bind(this.wasPlayed,this),this.wasPaused=__bind(this.wasPaused,this),this.video.addEventListener("pause",this.wasPaused),this.video.addEventListener("play",this.wasPlayed),Bigscreen.Utils.Events.delegate("click",this.video.parentNode,".bigscreen-pause-button",this.onClick)}return a.prototype.wasPaused=function(){return Bigscreen.Utils.ClassList.add("bigscreen-is-paused",this.video.parentNode)},a.prototype.wasPlayed=function(){return Bigscreen.Utils.ClassList.remove("bigscreen-is-paused",this.video.parentNode)},a.prototype.onClick=function(){return this.video.paused?void 0:this.video.pause()},a.prototype.render=function(){return JST["bigscreen/templates/pause_button"]()},a.prototype.getElement=function(){return this.video.parentNode.querySelector(".bigscreen-pause-button")},a}();var __bind=function(a,b){return function(){return a.apply(b,arguments)}};this.Bigscreen||(this.Bigscreen={}),Bigscreen.PlayButton=function(){function a(a){this.video=a,this.onClick=__bind(this.onClick,this),this.wasPaused=__bind(this.wasPaused,this),this.wasPlayed=__bind(this.wasPlayed,this),this.video.addEventListener("play",this.wasPlayed),this.video.addEventListener("pause",this.wasPaused),Bigscreen.Utils.Events.delegate("click",this.video.parentNode,".bigscreen-play-button",this.onClick)}return a.prototype.wasPlayed=function(){return Bigscreen.Utils.ClassList.add("bigscreen-is-playing",this.video.parentNode)},a.prototype.wasPaused=function(){return Bigscreen.Utils.ClassList.remove("bigscreen-is-playing",this.video.parentNode)},a.prototype.onClick=function(){return this.video.paused?this.video.play():void 0},a.prototype.getElement=function(){return this.video.parentNode.querySelector(".bigscreen-play-button")},a.prototype.render=function(){return JST["bigscreen/templates/play_button"]()},a}();var __bind=function(a,b){return function(){return a.apply(b,arguments)}};this.Bigscreen||(this.Bigscreen={}),Bigscreen.PlaybackRateControl=function(){function a(a){this.video=a,this.onOptionChange=__bind(this.onOptionChange,this),this.rateWasChanged=__bind(this.rateWasChanged,this),this.video.addEventListener("ratechange",this.rateWasChanged),Bigscreen.Utils.Events.delegate("change",this.video.parentNode,".bigscreen-playback-rate-control input",this.onOptionChange)}return a.prototype.rateWasChanged=function(){var a;return a=this.getElement().querySelector("li[data-playback-rate='"+this.video.playbackRate+"']"),a?a.querySelector("input[type=radio]").checked=!0:this.getElement().querySelector("input[type=radio][checked]").checked=!1},a.prototype.onOptionChange=function(a){return this.video.playbackRate=a.target.value},a.prototype.getElement=function(){return this.video.parentNode.querySelector(".bigscreen-playback-rate-control")},a.prototype.render=function(){return JST["bigscreen/templates/playback_rate_control"]()},a}();var __bind=function(a,b){return function(){return a.apply(b,arguments)}};this.Bigscreen||(this.Bigscreen={}),Bigscreen.ProgressControl=function(){function a(a){this.video=a,this.onMouseMove=__bind(this.onMouseMove,this),this.onMouseOut=__bind(this.onMouseOut,this),this.onMouseOver=__bind(this.onMouseOver,this),this.onClick=__bind(this.onClick,this),this.onTimeUpdate=__bind(this.onTimeUpdate,this),this.video.addEventListener("timeupdate",this.onTimeUpdate),this.video.addEventListener("load",this.setDuration),Bigscreen.Utils.Events.delegate("click",this.video.parentNode,".bigscreen-progress-bar",this.onClick),Bigscreen.Utils.Events.delegate("mouseover",this.video.parentNode,".bigscreen-progress-bar",this.onMouseOver),Bigscreen.Utils.Events.delegate("mouseout",this.video.parentNode,".bigscreen-progress-bar",this.onMouseOut),this.durationSet=!1}return a.prototype.onTimeUpdate=function(){return this.durationSet||this.setDuration(),this.updateCurrentTime(),this.updateProgressBar()},a.prototype.setDuration=function(){var a;return a=this.getElement(".bigscreen-duration-label"),a.textContent=this.secondsToTimeLabel(this.video.duration),this.durationSet=!0},a.prototype.updateCurrentTime=function(){var a;return a=this.getElement(".bigscreen-current-time-label"),a.textContent=this.secondsToTimeLabel(this.video.currentTime)},a.prototype.updateProgressBar=function(){var a;return a=this.video.currentTime/this.video.duration*100,this.getElement(".bigscreen-progress").setAttribute("style","width: "+a+"%")},a.prototype.onClick=function(a){var b,c;return b=this.getElement(".bigscreen-progress-bar"),c=this.relativeXOffset(a.pageX,b)/b.clientWidth,this.video.currentTime=this.video.duration*c},a.prototype.onMouseOver=function(){return this.getElement(".bigscreen-progress-bar").addEventListener("mousemove",this.onMouseMove),this.getElement(".bigscreen-progress-tooltip").setAttribute("style","display: block")},a.prototype.onMouseOut=function(){return this.getElement(".bigscreen-progress-bar").removeEventListener("mousemove",this.onMouseMove),this.getElement(".bigscreen-progress-tooltip").setAttribute("style","display: none")},a.prototype.onMouseMove=function(a){var b,c,d;return b=this.getElement(".bigscreen-progress-bar"),c=this.relativeXOffset(a.pageX,b)/b.clientWidth,d=this.getElement(".bigscreen-progress-tooltip"),d.textContent=this.secondsToTimeLabel(this.video.duration*c),d.setAttribute("style","left: "+100*c+"%")},a.prototype.getElement=function(a){var b;return b=".bigscreen-progress-control",null!=a&&(b=b+=" "+a),this.video.parentNode.querySelector(b)},a.prototype.render=function(){return JST["bigscreen/templates/progress_control"]()},a.prototype.secondsToTimeLabel=function(a){var b,c,d;return b=Math.floor(a/3600),c=Math.floor(a/60)%60,a=Math.floor(a)%60,d="",b>0&&(d+=""+this.formatTimeSegment(b)+":"),d+=""+this.formatTimeSegment(c)+":"+this.formatTimeSegment(a)},a.prototype.formatTimeSegment=function(a){var b;return b="00",(b+a).slice(-b.length)},a.prototype.relativeXOffset=function(a,b){var c;return c=b.getBoundingClientRect().left+window.pageXOffset-document.documentElement.clientLeft,a-c},a}(),this.Bigscreen||(this.Bigscreen={}),Bigscreen.Tv=function(){function a(a){this.video=a,Bigscreen.Utils.ClassList.add("bigscreen-is-paused",this.video.parentNode),this.features={playButton:new Bigscreen.PlayButton(a),pauseButton:new Bigscreen.PauseButton(a),playbackRateControl:Bigscreen.Utils.FeatureDetects.playbackRate?new Bigscreen.PlaybackRateControl(a):null,captionControl:new Bigscreen.CaptionControl(a),captionLayer:new Bigscreen.CaptionLayer(a),progressControl:new Bigscreen.ProgressControl(a),fullscreenControl:new Bigscreen.FullscreenControl(a)},this.render(this.features)}return a.prototype.render=function(a){var b;return b=document.createElement("div"),b.className="bigscreen-features",b.innerHTML=JST["bigscreen/templates/tv"](a),this.video.parentNode.appendChild(b)},a}(),this.Bigscreen||(this.Bigscreen={}),Bigscreen.Utils||(Bigscreen.Utils={}),Bigscreen.Utils.ClassList=function(){function a(){}return a.supportsClassList=null!=document.documentElement.classList,a.parseClassList=function(a){return""===a.className?[]:a.className.replace(/^\s+|\s+$/g,"").split(/\s+/)},a.add=function(a,b){var c;return this.supportsClassList?b.classList.add(a):(c=this.parseClassList(b),-1===c.indexOf(a)&&c.push(a),b.className=c.join(" "))},a.remove=function(a,b){var c,d;return this.supportsClassList?b.classList.remove(a):(c=this.parseClassList(b),d=c.indexOf(a),-1!==d?(c.splice(d,1),b.className=c.join(" ")):void 0)},a}(),this.Bigscreen||(this.Bigscreen={}),Bigscreen.Utils||(Bigscreen.Utils={}),Bigscreen.Utils.Enumerable=function(){function a(){}return a.includes=function(a,b){var c,d,e;if(a.indexOf)return a.indexOf(b)>=0;for(d=0,e=a.length;e>d;d++)if(c=a[d],c===b)return!0;return!1},a}(),this.Bigscreen||(this.Bigscreen={}),Bigscreen.Utils||(Bigscreen.Utils={}),Bigscreen.Utils.Events=function(){function a(){}return a.delegate=function(a,b,c,d){return b.addEventListener(a,function(a){var e,f,g,h;for(g=b.querySelectorAll(c),e=a.target,h=[];e!==b;)f=Bigscreen.Utils.Enumerable.includes(g,e),f&&d.apply(this,arguments),h.push(e=e.parentNode);return h})},a}(),this.Bigscreen||(this.Bigscreen={}),Bigscreen.Utils||(Bigscreen.Utils={}),Bigscreen.Utils.FeatureDetects=function(){function a(){}return a.playbackRate=null!=document.createElement("video").playbackRate,a}(),this.JST=this.JST||{},this.JST["bigscreen/templates/caption_control"]=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",captionsData.length){__p+='\n  <div class="bigscreen-caption-control">\n    <div class="bigscreen-control-headline">\n      Caption Language\n    </div>\n    <ul>\n      <li data-caption-language="none">\n        <label>\n          <input type="radio"\n            name="bigscreen-caption-language"\n            id="bigscreen-caption-language-none"\n            value="none"\n            checked>\n          <span class="bigscreen-label-value">None</span>\n        </label>\n      </li>\n\n      ';for(var i in captionsData){__p+="\n        ";var track=captionsData[i];__p+='\n        <li data-caption-language="'+(null==(__t=track.language)?"":__t)+'">\n          <label>\n            <input type="radio"\n              name="bigscreen-caption-language"\n              id="bigscreen-caption-language-'+(null==(__t=track.language)?"":__t)+'"\n              value="'+(null==(__t=track.language)?"":__t)+'">\n            <span class="bigscreen-label-value">'+(null==(__t=track.title)?"":__t)+"</span>\n          </label>\n        </li>\n      "}__p+="\n    </ul>\n  </div>\n"}__p+="\n"}return __p},this.JST["bigscreen/templates/caption_layer"]=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="bigscreen-caption-layer">\n  <div class="bigscreen-caption-content">\n  </div>\n</div>\n';return __p},this.JST["bigscreen/templates/fullscreen_control"]=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<a class="bigscreen-fullscreen-control">Toggle Fullscreen</a>\n';return __p},this.JST["bigscreen/templates/pause_button"]=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<a class="bigscreen-pause-button">Pause</a>\n';return __p},this.JST["bigscreen/templates/play_button"]=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<a class="bigscreen-play-button">Play</a>\n';return __p},this.JST["bigscreen/templates/playback_rate_control"]=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="bigscreen-playback-rate-control">\n  <div class="bigscreen-control-headline">\n    Video speed\n  </div>\n  <ul>\n    <li data-playback-rate="1">\n      <label for="bigscreen-playback-rate-normal">\n        <input type="radio"\n          name="bigscreen-playback-rate"\n          id="bigscreen-playback-rate-normal"\n          value="1"\n          checked>\n        <span class="bigscreen-label-value">Normal</span>\n      </label>\n    </li>\n    <li data-playback-rate="1.5">\n      <label for="bigscreen-playback-rate-1-5x">\n        <input type="radio"\n          name="bigscreen-playback-rate"\n          id="bigscreen-playback-rate-1-5x"\n          value="1.5">\n        <span class="bigscreen-label-value">1.5x</span>\n      </label>\n    </li>\n    <li data-playback-rate="2">\n      <label for="bigscreen-playback-rate-2-0x">\n        <input type="radio"\n          name="bigscreen-playback-rate"\n          id="bigscreen-playback-rate-2-0x"\n          value="2">\n        <span class="bigscreen-label-value">2.0x</span>\n      </label>\n    </li>\n  </ul>\n</div>\n';return __p},this.JST["bigscreen/templates/progress_control"]=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="bigscreen-progress-control">\n  <div class="bigscreen-time-label bigscreen-current-time-label">0:00</div>\n  <div class="bigscreen-progress-bar">\n    <div class="bigscreen-progress"></div>\n    <div class="bigscreen-progress-tooltip" style="display: none">0:00</div>\n  </div>\n  <div class="bigscreen-time-label bigscreen-duration-label">0:00</div>\n</div>\n';return __p},this.JST["bigscreen/templates/tv"]=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="bigscreen-layers">\n  '+(null==(__t=captionLayer.render())?"":__t)+'\n</div>\n\n<div class="bigscreen-controls">\n  '+(null==(__t=playButton.render())?"":__t)+"\n  "+(null==(__t=pauseButton.render())?"":__t)+"\n  "+(null==(__t=progressControl.render())?"":__t)+"\n  ",playbackRateControl&&(__p+="\n    "+(null==(__t=playbackRateControl.render())?"":__t)+"\n  "),__p+="\n  "+(null==(__t=captionControl.render())?"":__t)+"\n  "+(null==(__t=fullscreenControl.render())?"":__t)+"\n</div>\n";return __p};