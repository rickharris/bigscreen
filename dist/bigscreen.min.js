this.Bigscreen||(this.Bigscreen={}),Bigscreen.CaptionControl=function(){function e(e){this.video=e}return e.prototype.captionsData=function(){var e,t,n,r,i;t=this.video.parentNode.querySelectorAll("track[kind=subtitles]"),i=[];for(n=0,r=t.length;n<r;n++)e=t[n],i.push(this.trackData(e));return i},e.prototype.trackData=function(e){return{language:e.getAttribute("srclang"),title:e.title||e.getAttribute("srclang")}},e.prototype.render=function(){var e;return e=this.captionsData(),JST["bigscreen/templates/caption_control"]({captionsData:e})},e}();var __bind=function(e,t){return function(){return e.apply(t,arguments)}};this.Bigscreen||(this.Bigscreen={}),Bigscreen.CaptionLayer=function(){function e(e){this.video=e,this.onTimeUpdate=__bind(this.onTimeUpdate,this),this.onLanguageChange=__bind(this.onLanguageChange,this),Bigscreen.Utils.Events.delegate("change",this.video.parentNode,".bigscreen-caption-control input",this.onLanguageChange),this.processedLanguages={error:"The selected language isn't available.",none:" "}}return e.prototype.onLanguageChange=function(e){var t,n;return n=e.target.value,this.processedLanguages[n]?this.setActiveLanguage(n):(t=this.video.querySelector("track[kind=subtitles][srclang="+n+"]"),this.processCaptionTrack(t))},e.prototype.processCaptionTrack=function(e){var t=this;return this.request=new XMLHttpRequest,this.request.open("GET",e.getAttribute("src")),this.request.onreadystatechange=function(){if(t.request.readyState===4)return t.request.status===200?(t.parseCaptions(e.getAttribute("srclang"),t.request.responseText),t.setActiveLanguage(e.getAttribute("srclang"))):t.setActiveLanguage("error")},this.request.send()},e.prototype.parseCaptions=function(e,t){var n,r,i,s,o;s=/^[0-9]+$/,o=t.split(/\r?\n/),n=[],i=0;while(i<o.length)o[i].match(s)&&(r={},r.times=this.parseTimeCode(o[i+1]),r.text=o[i+2],n.push(r)),i++;return this.processedLanguages[e]=n},e.prototype.parseTimeCode=function(e){var t,n,r,i,s,o;return o=/^([0-9]{2}):([0-9]{2}):([0-9]{2}),([0-9]{1,3}) --\> ([0-9]{2}):([0-9]{2}):([0-9]{2}),([0-9]{1,3})$/,r=o.exec(e),i={hours:parseInt(r[1],10),minutes:parseInt(r[2],10),seconds:parseInt(r[3],10),miliseconds:parseInt(r[4],10)},t={hours:parseInt(r[5],10),minutes:parseInt(r[6],10),seconds:parseInt(r[7],10),miliseconds:parseInt(r[8],10)},s=i.hours*60*60+i.minutes*60+i.seconds+i.miliseconds/1e3,n=t.hours*60*60+t.minutes*60+t.seconds+t.miliseconds/1e3,[s,n]},e.prototype.setActiveLanguage=function(e){return this.currentLanguage=this.processedLanguages[e],typeof this.currentLanguage=="string"?(this.video.removeEventListener("timeupdate",this.onTimeUpdate),this.showCaptionMessage(this.currentLanguage)):(this.video.removeEventListener("timeupdate",this.onTimeUpdate),this.video.addEventListener("timeupdate",this.onTimeUpdate))},e.prototype.showCaptionMessage=function(e){var t;return t=this.getElement().querySelector(".bigscreen-caption-content"),t.textContent=e},e.prototype.onTimeUpdate=function(e){var t,n,r,i,s,o;n=this.video.currentTime,s=this.currentLanguage,o=[];for(r=0,i=s.length;r<i;r++)t=s[r],n>=t.times[0]&&n<t.times[1]?o.push(this.showCaptionMessage(t.text)):o.push(void 0);return o},e.prototype.getElement=function(){return this.video.parentNode.querySelector(".bigscreen-caption-layer")},e.prototype.render=function(){return JST["bigscreen/templates/caption_layer"]()},e}();var __bind=function(e,t){return function(){return e.apply(t,arguments)}};this.Bigscreen||(this.Bigscreen={}),Bigscreen.PauseButton=function(){function e(e){this.video=e,this.onClick=__bind(this.onClick,this),this.wasPlayed=__bind(this.wasPlayed,this),this.wasPaused=__bind(this.wasPaused,this),this.video.addEventListener("pause",this.wasPaused),this.video.addEventListener("play",this.wasPlayed),Bigscreen.Utils.Events.delegate("click",this.video.parentNode,".bigscreen-pause-button",this.onClick)}return e.prototype.wasPaused=function(){return Bigscreen.Utils.ClassList.add("is-paused",this.getElement())},e.prototype.wasPlayed=function(){return Bigscreen.Utils.ClassList.remove("is-paused",this.getElement())},e.prototype.onClick=function(){if(!this.video.paused)return this.video.pause()},e.prototype.render=function(){return JST["bigscreen/templates/pause_button"]()},e.prototype.getElement=function(){return this.video.parentNode.querySelector(".bigscreen-pause-button")},e}();var __bind=function(e,t){return function(){return e.apply(t,arguments)}};this.Bigscreen||(this.Bigscreen={}),Bigscreen.PlayButton=function(){function e(e){this.video=e,this.onClick=__bind(this.onClick,this),this.wasPaused=__bind(this.wasPaused,this),this.wasPlayed=__bind(this.wasPlayed,this),this.video.addEventListener("play",this.wasPlayed),this.video.addEventListener("pause",this.wasPaused),Bigscreen.Utils.Events.delegate("click",this.video.parentNode,".bigscreen-play-button",this.onClick)}return e.prototype.wasPlayed=function(e){return Bigscreen.Utils.ClassList.add("is-playing",this.getElement())},e.prototype.wasPaused=function(e){return Bigscreen.Utils.ClassList.remove("is-playing",this.getElement())},e.prototype.onClick=function(e){if(this.video.paused)return this.video.play()},e.prototype.getElement=function(){return this.video.parentNode.querySelector(".bigscreen-play-button")},e.prototype.render=function(){return JST["bigscreen/templates/play_button"]()},e}();var __bind=function(e,t){return function(){return e.apply(t,arguments)}};this.Bigscreen||(this.Bigscreen={}),Bigscreen.PlayToggle=function(){function e(e){this.video=e,this.render=__bind(this.render,this),this.toggle=__bind(this.toggle,this),this.onPause=__bind(this.onPause,this),this.onPlay=__bind(this.onPlay,this),this.video.addEventListener("play",this.onPlay),this.video.addEventListener("pause",this.onPause),Bigscreen.Utils.Events.delegate("click",this.video.parentNode,".bigscreen-play-toggle",this.toggle)}return e.prototype.onPlay=function(){return this.getElement().classList.add("bigscreen-is-playing"),this.getElement().classList.remove("bigscreen-is-paused")},e.prototype.onPause=function(){return this.getElement().classList.add("bigscreen-is-paused"),this.getElement().classList.remove("bigscreen-is-playing")},e.prototype.toggle=function(){return this.video.paused?this.video.play():this.video.pause()},e.prototype.getElement=function(){return this.element||(this.element=this.video.parentNode.querySelector(".bigscreen-play-toggle"))},e.prototype.render=function(){return JST["bigscreen/templates/play_toggle"]()},e}();var __bind=function(e,t){return function(){return e.apply(t,arguments)}};this.Bigscreen||(this.Bigscreen={}),Bigscreen.PlaybackRateControl=function(){function e(e){this.video=e,this.onOptionChange=__bind(this.onOptionChange,this),this.rateWasChanged=__bind(this.rateWasChanged,this),this.video.addEventListener("ratechange",this.rateWasChanged),Bigscreen.Utils.Events.delegate("change",this.video.parentNode,".bigscreen-playback-rate-control input",this.onOptionChange)}return e.prototype.rateWasChanged=function(){var e;return e=this.getElement().querySelector("li[data-playback-rate='"+this.video.playbackRate+"']"),e?e.querySelector("input[type=radio]").checked=!0:this.getElement().querySelector("input[type=radio][checked]").checked=!1},e.prototype.onOptionChange=function(e){return this.video.playbackRate=e.target.value},e.prototype.getElement=function(){return this.video.parentNode.querySelector(".bigscreen-playback-rate-control")},e.prototype.render=function(){return JST["bigscreen/templates/playback_rate_control"]()},e}(),this.Bigscreen||(this.Bigscreen={}),Bigscreen.Tv=function(){function e(e){this.video=e,this.features={playButton:new Bigscreen.PlayButton(e),pauseButton:new Bigscreen.PauseButton(e),playbackRateControl:Bigscreen.Utils.FeatureDetects.playbackRate?new Bigscreen.PlaybackRateControl(e):null,captionControl:new Bigscreen.CaptionControl(e),captionLayer:new Bigscreen.CaptionLayer(e)},this.render(this.features)}return e.prototype.render=function(e){var t;return t=document.createElement("div"),t.className="bigscreen-features",t.innerHTML=JST["bigscreen/templates/tv"](e),this.video.parentNode.appendChild(t)},e}(),this.Bigscreen||(this.Bigscreen={}),Bigscreen.Utils||(Bigscreen.Utils={}),Bigscreen.Utils.ClassList=function(){function e(){}return e.supportsClassList=document.documentElement.classList!=null,e.parseClassList=function(e){return e.className===""?[]:e.className.replace(/^\s+|\s+$/g,"").split(/\s+/)},e.add=function(e,t){var n;return this.supportsClassList?t.classList.add(e):(n=this.parseClassList(t),n.indexOf(e)===-1&&n.push(e),t.className=n.join(" "))},e.remove=function(e,t){var n,r;if(this.supportsClassList)return t.classList.remove(e);n=this.parseClassList(t),r=n.indexOf(e);if(r!==-1)return n.splice(r,1),t.className=n.join(" ")},e}(),this.Bigscreen||(this.Bigscreen={}),Bigscreen.Utils||(Bigscreen.Utils={}),Bigscreen.Utils.Enumerable=function(){function e(){}return e.includes=function(e,t){var n,r,i;if(e.indexOf)return e.indexOf(t)>=0;for(r=0,i=e.length;r<i;r++){n=e[r];if(n===t)return!0}return!1},e}(),this.Bigscreen||(this.Bigscreen={}),Bigscreen.Utils||(Bigscreen.Utils={}),Bigscreen.Utils.Events=function(){function e(){}return e.delegate=function(e,t,n,r){return t.addEventListener(e,function(e){var i,s;s=t.querySelectorAll(n),i=Bigscreen.Utils.Enumerable.includes(s,e.target);if(i)return r.apply(this,arguments)})},e}(),this.Bigscreen||(this.Bigscreen={}),Bigscreen.Utils||(Bigscreen.Utils={}),Bigscreen.Utils.FeatureDetects=function(){function e(){}return e.playbackRate=document.createElement("video").playbackRate!=null,e}(),this.JST=this.JST||{},this.JST["bigscreen/templates/caption_control"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{}){__p+="";if(captionsData.length){__p+='\n  <div class="bigscreen-caption-control">\n    <div class="bigscreen-control-headline">\n      Caption Language\n    </div>\n    <ul>\n      <li data-caption-language="none">\n        <input type="radio"\n          name="bigscreen-caption-language"\n          id="bigscreen-caption-language-none"\n          value="none"\n          checked>\n        <span class="bigscreen-label-value">None</span>\n      </li>\n\n      ';for(var i in captionsData){__p+="\n        ";var track=captionsData[i];__p+='\n        <li data-caption-language="'+track.language+'">\n          <input type="radio"\n            name="bigscreen-caption-language"\n            id="bigscreen-caption-language-'+track.language+'"\n            value="'+track.language+'">\n          <span class="bigscreen-label-value">'+track.title+"</span>\n        </li>\n      "}__p+="\n    </ul>\n  </div>\n"}__p+="\n"}return __p},this.JST["bigscreen/templates/caption_layer"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+='<div class="bigscreen-caption-layer">\n  <div class="bigscreen-caption-content">\n  </div>\n</div>\n';return __p},this.JST["bigscreen/templates/pause_button"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+='<a class="bigscreen-pause-button is-paused">Pause</a>\n';return __p},this.JST["bigscreen/templates/play_button"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+='<a class="bigscreen-play-button">Play</a>\n';return __p},this.JST["bigscreen/templates/playback_rate_control"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+='<div class="bigscreen-playback-rate-control">\n  <div class="bigscreen-control-headline">\n    Video speed\n  </div>\n  <ul>\n    <li data-playback-rate="1">\n      <label for="bigscreen-playback-rate-normal">\n        <input type="radio"\n          name="bigscreen-playback-rate"\n          id="bigscreen-playback-rate-normal"\n          value="1"\n          checked>\n        <span class="bigscreen-label-value">Normal</span>\n      </label>\n    </li>\n    <li data-playback-rate="1.5">\n      <label for="bigscreen-playback-rate-1-5x">\n        <input type="radio"\n          name="bigscreen-playback-rate"\n          id="bigscreen-playback-rate-1-5x"\n          value="1.5">\n        <span class="bigscreen-label-value">1.5x</span>\n      </label>\n    </li>\n    <li data-playback-rate="2">\n      <label for="bigscreen-playback-rate-2-0x">\n        <input type="radio"\n          name="bigscreen-playback-rate"\n          id="bigscreen-playback-rate-2-0x"\n          value="2">\n        <span class="bigscreen-label-value">2.0x</span>\n      </label>\n    </li>\n  </ul>\n</div>\n';return __p},this.JST["bigscreen/templates/tv"]=function(obj){var __p="",print=function(){__p+=Array.prototype.join.call(arguments,"")};with(obj||{})__p+=""+captionLayer.render()+"\n"+playButton.render()+"\n"+pauseButton.render()+"\n",playbackRateControl&&(__p+="\n  "+playbackRateControl.render()+"\n"),__p+="\n"+captionControl.render()+"\n";return __p};